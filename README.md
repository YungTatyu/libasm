# x86-64 Assembly (Intel 64bit)

## 📦 レジスタ一覧（64ビット）

| レジスタ   | 用途                                          | 呼び出し間で保持 | 具体例（NASM）                                      |
|------------|-----------------------------------------------|------------------|----------------------------------------------------|
| `%rax`     | 一時レジスタ・関数戻り値                       | No               | `mov rax, 10` ; raxに10をセット                    |
| `%rbx`     | callee-saved（呼ばれた関数が保存）             | Yes              | `mov rbx, rax` ; rbxにraxの値をコピー              |
| `%rcx`     | 第4引数、またはループカウンタなど               | No               | `mov rcx, 5` ; ループカウンタを5に設定             |
| `%rdx`     | 第3引数                                        | No               | `mov rdx, rdi` ; 第3引数にrdiの値を入れる           |
| `%rsp`     | スタックポインタ                               | Yes              | `push rax` ; raxをスタックに積む                    |
| `%rbp`     | ベースポインタ（フレームポインタ）             | Yes              | `mov rbp, rsp` ; スタックフレーム開始               |
| `%rsi`     | 第2引数                                        | No               | `mov rsi, [rbp+16]` ; 第2引数をメモリからロード     |
| `%rdi`     | 第1引数                                        | No               | `mov rdi, 1` ; 第1引数に1をセット                   |
| `%r8`      | 第5引数                                        | No               | `mov r8, 100` ; 第5引数に100をセット                 |
| `%r9`      | 第6引数                                        | No               | `mov r9, 200` ; 第6引数に200をセット                 |
| `%r10-%r11`| 一時レジスタ                                   | No               | `mov r10, rax` ; 一時的にraxを保存                   |
| `%r12-%r15`| callee-saved                                   | Yes              | `mov r12, rbx` ; r12を呼び出し側保存用に使う         |


## 🔧 基本命令

### データ操作

| 命令             | 説明                             | 例                      |
|------------------|----------------------------------|-------------------------|
| `mov dst, src`   | データ転送                       | `mov rax, 5`            |
| `lea dst, [src]` | アドレス計算（ポインタ）         | `lea rax, [rbx + 8]`    |

### 算術演算

| 命令         | 説明                 | 例                      |
|--------------|----------------------|-------------------------|
| `add r1, r2` | 加算（r1 += r2）     | `add rax, rbx`          |
| `sub r1, r2` | 減算（r1 -= r2）     | `sub rax, 1`            |
| `imul r1, r2`| 符号付き乗算         | `imul rax, rbx`         |
| `idiv r2`    | 符号付き除算         | `cqo` → `idiv rcx`      |

### 分岐・ジャンプ

| 命令         | 説明                          | 例                     |
|--------------|-------------------------------|------------------------|
| `cmp r1, r2` | 比較（r1 - r2）               | `cmp rax, 10`          |
| `je label`   | 等しければジャンプ           | `je .equal_case`       |
| `jne label`  | 等しくなければジャンプ       | `jne .not_equal`       |
| `jmp label`  | 無条件ジャンプ               | `jmp .loop_start`      |


## 🔁 System V ABI の関数引数の渡し方（Linux）

| 引数の順番 | レジスタ |
|------------|----------|
| 第1引数    | `%rdi`   |
| 第2引数    | `%rsi`   |
| 第3引数    | `%rdx`   |
| 第4引数    | `%rcx`   |
| 第5引数    | `%r8`    |
| 第6引数    | `%r9`    |
| それ以降   | スタック |
